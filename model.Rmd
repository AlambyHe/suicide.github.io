---
title: "Model"
output: 
  html_document:
    code_folding: hide
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse) # general
library(ggalt) # dumbbell plots
library(countrycode) # continent
library(rworldmap) # quick country-level heat maps
library(gridExtra) # plots
library(broom) # significant trends within countries
theme_set(theme_light())
library(plyr)
library(dplyr)
library(lubridate)
library(caTools)
library(ggplot2)
library(ggthemes)
library(reshape2)
library(data.table)
library(tidyr)
library(corrgram)       
library(corrplot)
library(formattable)
library(cowplot)
library(ggpubr)
library(plot3D)
```

Suicide rate chages with year

```{r}

```



Happiness score are related to ?

```{r, message=FALSE, warning=FALSE}
## clean the data
data <- read_csv("./data/master.csv") %>% 
  janitor::clean_names()
survey <- read_csv("./data/survey.csv") %>% 
  janitor::clean_names()
happiness_2015 <- read_csv("./data/2015.csv") %>% 
  janitor::clean_names() %>% 
  mutate(
    year = 2015
  ) %>% 
  select(-region, -standard_error)
happiness_2016 <- read_csv("./data/2016.csv") %>% 
  janitor::clean_names() %>% 
  mutate(
    year = 2016
  ) %>% 
  select(-region, -lower_confidence_interval, -upper_confidence_interval)
happiness_2017 <- read_csv("./data/2017.csv") %>% 
  janitor::clean_names() %>% 
  mutate(
    year = 2017
  ) %>% 
  select(-whisker_high, -whisker_low) 

happiness_2015 = happiness_2015[, c(1,11,2,3,4,5,6,7,8,9,10)]
happiness_2016 = happiness_2016[, c(1,11,2,3,4,5,6,7,8,9,10)]
happiness_2017 = happiness_2017[, c(1,11,2,3,4,5,6,7,9,8,10)]
happiness = rbind(happiness_2015, happiness_2016, happiness_2017)

## generate correlation plot
happiness_2015_cor = happiness_2015 %>% select(-year)
happiness_2016_cor = happiness_2016 %>% select(-year)
happiness_2017_cor = happiness_2017 %>% select(-year)
Num.cols_2015 <- sapply(happiness_2015_cor, is.numeric)
Num.cols_2016 <- sapply(happiness_2016_cor, is.numeric)
Num.cols_2017 <- sapply(happiness_2017_cor, is.numeric)
Cor.data_2015 <- cor(happiness_2015_cor[, Num.cols_2015])
Cor.data_2016 <- cor(happiness_2016_cor[, Num.cols_2016])
Cor.data_2017 <- cor(happiness_2017_cor[, Num.cols_2017])

corrplot(Cor.data_2015, method = 'square', addCoef.col = "black", tl.col ="black", tl.srt=45, diag = FALSE, number.cex = .7, title = "correlation between happiness and other variables in 2015") 
corrplot(Cor.data_2016, method = 'square', addCoef.col = "black", tl.col ="black", tl.srt=45, diag = FALSE, number.cex = .7, title = "correlation between happiness and other variables in 2016")  
corrplot(Cor.data_2017, method = 'square', addCoef.col = "black", tl.col ="black", tl.srt=45, diag = FALSE, number.cex = .7, title = "correlation between happiness and other variables in 2017")  


```




